name: Generate PDF of Notebook and Theoretical
run-name: Generating PDF of Notebook and Theoretical
on: [push]

jobs:
  generate-pdfs:
    permissions: write-all
    runs-on: ubuntu-latest
    steps:
      - name: install latex packages
        run: sudo apt install texlive texinfo texlive-fonts-recommended texlive-latex-extra

      - name: checkout repository content
        uses: actions/checkout@v3

      - name: generating notebook pdf
        run: python generate_latex/generate_notebook.py

      - name: generating theoretical pdf
        run: python generate_latex/generate_theoretical.py

      - name: Upload theoretical.pdf
        uses: actions/upload-artifact@v3
        with:
          name: theoretical.pdf
          path: ./theoretical.pdf
      
      - name: Upload notebook.pdf
        uses: actions/upload-artifact@v3
        with:
          name: notebook.pdf
          path: ./notebook.pdf

  release-project:
    needs: generate-pdfs
    permissions: write-all
    runs-on: ubuntu-latest
    steps:
      - name: Download artifact theoretical.pdf
        uses: actions/download-artifact@v3
        with:
          name: theoretical.pdf

      - name: Download artifact notebook.pdf
        uses: actions/download-artifact@v3
        with:
          name: notebook.pdf

      - name: "Create GitHub release"
        uses: "marvinpinto/action-automatic-releases@latest"
        with:
          repo_token: "${{ secrets.GITHUB_TOKEN }}"
          automatic_release_tag: "latest"
          prerelease: false
          title: Release ${{ github.ref }}
          files: |
            theoretical.pdf
            notebook.pdf
